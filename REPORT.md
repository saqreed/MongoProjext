# üìä –û—Ç—á–µ—Ç –ø–æ –ø—Ä–æ–µ–∫—Ç—É "–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–µ–π"

## üìã –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:** MongoDB Project - –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–µ–π  
**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Node.js, Express.js, MongoDB, HTML5, CSS3, JavaScript, Bootstrap 5  
**–¢–∏–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:** –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å REST API  
**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** https://github.com/saqreed/MongoProjext.git

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∑–∞–¥–∞–Ω–∏—è

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ ‚úÖ

**–°–æ–∑–¥–∞–Ω–∞ –ë–î:** `company_db` —Å 4 –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏:
- `users` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã
- `employees` - —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∫–æ–º–ø–∞–Ω–∏–∏  
- `projects` - –ø—Ä–æ–µ–∫—Ç—ã –∫–æ–º–ø–∞–Ω–∏–∏
- `departments` - –æ—Ç–¥–µ–ª—ã –∫–æ–º–ø–∞–Ω–∏–∏

### 2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ‚úÖ

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:** –°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –ø–æ–ª–Ω—ã–º CRUD —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º

### 3. –¢—Ä–∏ —É—Ä–æ–≤–Ω—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚úÖ

| –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | –õ–æ–≥–∏–Ω | –ü–∞—Ä–æ–ª—å | –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ |
|--------------|-------|--------|---------------|
| **admin** | admin | admin123 | –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø (CRUD) |
| **manager** | manager | manager123 | –ß—Ç–µ–Ω–∏–µ + –∏–∑–º–µ–Ω–µ–Ω–∏–µ |
| **viewer** | viewer | viewer123 | –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ |

### 4. –ü—Ä–æ–¥—É–º–∞–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã ‚úÖ

**–°–æ–∑–¥–∞–Ω—ã –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ–∏—Å–∫–∞ –ø–æ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º –ø–æ–ª—è–º**

### 5. –û—Ç—á–µ—Ç–Ω—ã–µ —Ñ–æ—Ä–º—ã ‚úÖ

**–ê–≥—Ä–µ–≥–∞—Ü–∏—è:** 3 –æ—Ç—á–µ—Ç–∞ —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏  
**–ü—Ä–æ—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã:** –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

---

## üñ•Ô∏è –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (–¥–ª—è –æ—Ç—á–µ—Ç–∞ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å):

1. **–°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞** - `http://localhost:3000`
2. **–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è** - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞
3. **–†–∞–∑–¥–µ–ª "–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏"** - —Ç–∞–±–ª–∏—Ü–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –∏ –ø–æ–∏—Å–∫–æ–º
4. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞** - –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
5. **–†–∞–∑–¥–µ–ª "–ü—Ä–æ–µ–∫—Ç—ã"** - –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤
6. **–†–∞–∑–¥–µ–ª "–û—Ç–¥–µ–ª—ã"** - –∫–∞—Ä—Ç–æ—á–∫–∏ –æ—Ç–¥–µ–ª–æ–≤
7. **–†–∞–∑–¥–µ–ª "–û—Ç—á–µ—Ç—ã"** - 3 –æ—Ç—á–µ—Ç–∞ —Å –∞–≥—Ä–µ–≥–∞—Ü–∏–µ–π

---

## üîß –ë—ç–∫–µ–Ω–¥ - API Endpoints –∏ –∫–æ–¥

### 1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

#### POST `/api/auth/login` - –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É

```javascript
app.post('/api/auth/login', async (req, res) => {
  try {
    const { username, password } = req.body;
    const user = await db.collection('users').findOne({ username });
    
    if (!user || !await bcrypt.compare(password, user.password)) {
      return res.status(401).json({ error: '–ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ' });
    }

    const token = jwt.sign(
      { userId: user._id, username: user.username, permissions: user.permissions },
      process.env.JWT_SECRET,
      { expiresIn: '24h' }
    );

    res.json({ token, user: { username: user.username, permissions: user.permissions } });
  } catch (error) {
    res.status(500).json({ error: '–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' });
  }
});
```

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π —Å bcrypt
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è JWT —Ç–æ–∫–µ–Ω–∞
- –í–æ–∑–≤—Ä–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Ç–æ–∫–µ–Ω–∞

---

### 2. CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤

#### GET `/api/employees` - –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤

```javascript
app.get('/api/employees', authenticateToken, checkPermission('read'), async (req, res) => {
  try {
    const employees = await db.collection('employees').find({}).toArray();
    res.json(employees);
  } catch (error) {
    res.status(500).json({ error: '–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤' });
  }
});
```

#### POST `/api/employees` - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞

```javascript
app.post('/api/employees', authenticateToken, checkPermission('write'), async (req, res) => {
  try {
    const result = await db.collection('employees').insertOne(req.body);
    res.status(201).json({ message: '–°–æ—Ç—Ä—É–¥–Ω–∏–∫ –¥–æ–±–∞–≤–ª–µ–Ω', id: result.insertedId });
  } catch (error) {
    res.status(500).json({ error: '–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞' });
  }
});
```

#### PUT `/api/employees/:id` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞

```javascript
app.put('/api/employees/:id', authenticateToken, checkPermission('write'), async (req, res) => {
  try {
    const { ObjectId } = require('mongodb');
    const result = await db.collection('employees').updateOne(
      { _id: new ObjectId(req.params.id) },
      { $set: req.body }
    );
    res.json({ message: '–°–æ—Ç—Ä—É–¥–Ω–∏–∫ –æ–±–Ω–æ–≤–ª–µ–Ω', modifiedCount: result.modifiedCount });
  } catch (error) {
    res.status(500).json({ error: '–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞' });
  }
});
```

#### DELETE `/api/employees/:id` - –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞

```javascript
app.delete('/api/employees/:id', authenticateToken, checkPermission('admin'), async (req, res) => {
  try {
    const { ObjectId } = require('mongodb');
    const result = await db.collection('employees').deleteOne({ _id: new ObjectId(req.params.id) });
    res.json({ message: '–°–æ—Ç—Ä—É–¥–Ω–∏–∫ —É–¥–∞–ª–µ–Ω', deletedCount: result.deletedCount });
  } catch (error) {
    res.status(500).json({ error: '–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞' });
  }
});
```

---

### 3. CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤

#### GET `/api/projects` - –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

```javascript
app.get('/api/projects', authenticateToken, checkPermission('read'), async (req, res) => {
  try {
    const projects = await db.collection('projects').find({}).toArray();
    res.json(projects);
  } catch (error) {
    res.status(500).json({ error: '–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–æ–≤' });
  }
});
```

#### POST `/api/projects` - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

```javascript
app.post('/api/projects', authenticateToken, checkPermission('write'), async (req, res) => {
  try {
    const result = await db.collection('projects').insertOne(req.body);
    res.status(201).json({ message: '–ü—Ä–æ–µ–∫—Ç –¥–æ–±–∞–≤–ª–µ–Ω', id: result.insertedId });
  } catch (error) {
    res.status(500).json({ error: '–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞' });
  }
});
```

#### PUT `/api/projects/:id` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

```javascript
app.put('/api/projects/:id', authenticateToken, checkPermission('write'), async (req, res) => {
  try {
    const { ObjectId } = require('mongodb');
    const result = await db.collection('projects').updateOne(
      { _id: new ObjectId(req.params.id) },
      { $set: req.body }
    );
    res.json({ message: '–ü—Ä–æ–µ–∫—Ç –æ–±–Ω–æ–≤–ª–µ–Ω', modifiedCount: result.modifiedCount });
  } catch (error) {
    res.status(500).json({ error: '–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞' });
  }
});
```

#### DELETE `/api/projects/:id` - –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

```javascript
app.delete('/api/projects/:id', authenticateToken, checkPermission('admin'), async (req, res) => {
  try {
    const { ObjectId } = require('mongodb');
    const result = await db.collection('projects').deleteOne({ _id: new ObjectId(req.params.id) });
    res.json({ message: '–ü—Ä–æ–µ–∫—Ç —É–¥–∞–ª–µ–Ω', deletedCount: result.deletedCount });
  } catch (error) {
    res.status(500).json({ error: '–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞' });
  }
});
```

---

### 4. CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –æ—Ç–¥–µ–ª–æ–≤

#### GET `/api/departments` - –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –æ—Ç–¥–µ–ª–æ–≤

```javascript
app.get('/api/departments', authenticateToken, checkPermission('read'), async (req, res) => {
  try {
    const departments = await db.collection('departments').find({}).toArray();
    res.json(departments);
  } catch (error) {
    res.status(500).json({ error: '–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–¥–µ–ª–æ–≤' });
  }
});
```

#### POST `/api/departments` - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–¥–µ–ª–∞

```javascript
app.post('/api/departments', authenticateToken, checkPermission('write'), async (req, res) => {
  try {
    const result = await db.collection('departments').insertOne(req.body);
    res.status(201).json({ message: '–û—Ç–¥–µ–ª –¥–æ–±–∞–≤–ª–µ–Ω', id: result.insertedId });
  } catch (error) {
    res.status(500).json({ error: '–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ—Ç–¥–µ–ª–∞' });
  }
});
```

#### PUT `/api/departments/:id` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–¥–µ–ª–∞

```javascript
app.put('/api/departments/:id', authenticateToken, checkPermission('write'), async (req, res) => {
  try {
    const { ObjectId } = require('mongodb');
    const result = await db.collection('departments').updateOne(
      { _id: new ObjectId(req.params.id) },
      { $set: req.body }
    );
    res.json({ message: '–û—Ç–¥–µ–ª –æ–±–Ω–æ–≤–ª–µ–Ω', modifiedCount: result.modifiedCount });
  } catch (error) {
    res.status(500).json({ error: '–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–¥–µ–ª–∞' });
  }
});
```

#### DELETE `/api/departments/:id` - –£–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–¥–µ–ª–∞

```javascript
app.delete('/api/departments/:id', authenticateToken, checkPermission('admin'), async (req, res) => {
  try {
    const { ObjectId } = require('mongodb');
    const result = await db.collection('departments').deleteOne({ _id: new ObjectId(req.params.id) });
    res.json({ message: '–û—Ç–¥–µ–ª —É–¥–∞–ª–µ–Ω', deletedCount: result.deletedCount });
  } catch (error) {
    res.status(500).json({ error: '–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –æ—Ç–¥–µ–ª–∞' });
  }
});
```

---

### 5. –û—Ç—á–µ—Ç—ã —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏

#### GET `/api/reports/employees-by-department` - –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –ø–æ –æ—Ç–¥–µ–ª–∞–º

```javascript
app.get('/api/reports/employees-by-department', authenticateToken, checkPermission('read'), async (req, res) => {
  try {
    const report = await db.collection('employees').aggregate([
      {
        $group: {
          _id: '$department',
          count: { $sum: 1 },
          avgSalary: { $avg: '$salary' },
          employees: { $push: { name: '$name', position: '$position' } }
        }
      },
      { $sort: { count: -1 } }
    ]).toArray();
    res.json(report);
  } catch (error) {
    res.status(500).json({ error: '–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞' });
  }
});
```

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ –æ—Ç–¥–µ–ª–∞–º
- –ü–æ–¥—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ –∫–∞–∂–¥–æ–º –æ—Ç–¥–µ–ª–µ
- –†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–π –∑–∞—Ä–ø–ª–∞—Ç—ã –ø–æ –æ—Ç–¥–µ–ª–∞–º
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤

#### GET `/api/reports/projects-by-status` - –ü—Ä–æ–µ–∫—Ç—ã –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º

```javascript
app.get('/api/reports/projects-by-status', authenticateToken, checkPermission('read'), async (req, res) => {
  try {
    const report = await db.collection('projects').aggregate([
      {
        $group: {
          _id: '$status',
          count: { $sum: 1 },
          totalBudget: { $sum: '$budget' },
          projects: { $push: { name: '$name', budget: '$budget' } }
        }
      }
    ]).toArray();
    res.json(report);
  } catch (error) {
    res.status(500).json({ error: '–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞' });
  }
});
```

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
- –ü–æ–¥—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ –≤ –∫–∞–∂–¥–æ–º —Å—Ç–∞—Ç—É—Å–µ
- –†–∞—Å—á–µ—Ç –æ–±—â–µ–≥–æ –±—é–¥–∂–µ—Ç–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
- –°–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞

#### GET `/api/reports/salary-statistics` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞—Ä–ø–ª–∞—Ç

```javascript
app.get('/api/reports/salary-statistics', authenticateToken, checkPermission('read'), async (req, res) => {
  try {
    const report = await db.collection('employees').aggregate([
      {
        $group: {
          _id: null,
          avgSalary: { $avg: '$salary' },
          minSalary: { $min: '$salary' },
          maxSalary: { $max: '$salary' },
          totalEmployees: { $sum: 1 }
        }
      }
    ]).toArray();
    res.json(report[0] || {});
  } catch (error) {
    res.status(500).json({ error: '–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞' });
  }
});
```

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–π –∑–∞—Ä–ø–ª–∞—Ç—ã
- –ü–æ–∏—Å–∫ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∑–∞—Ä–ø–ª–∞—Ç—ã
- –ü–æ–∏—Å–∫ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∑–∞—Ä–ø–ª–∞—Ç—ã
- –ü–æ–¥—Å—á–µ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤

---

### 6. –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã

#### GET `/api/search/employees` - –ü–æ–∏—Å–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤

```javascript
app.get('/api/search/employees', authenticateToken, checkPermission('read'), async (req, res) => {
  try {
    const { name, department, position } = req.query;
    let query = {};
    
    if (name) query.name = { $regex: name, $options: 'i' };
    if (department) query.department = department;
    if (position) query.position = { $regex: position, $options: 'i' };
    
    const employees = await db.collection('employees').find(query).toArray();
    res.json(employees);
  } catch (error) {
    res.status(500).json({ error: '–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤' });
  }
});
```

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ (—Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è, –Ω–µ—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –æ—Ç–¥–µ–ª—É (—Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ)
- –ü–æ–∏—Å–∫ –ø–æ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ (—Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è)
- –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º

---

## üîê –°–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### Middleware –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

```javascript
const authenticateToken = (req, res, next) => {
  const authHeader = req.headers['authorization'];
  const token = authHeader && authHeader.split(' ')[1];

  if (!token) {
    return res.status(401).json({ error: '–¢–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç' });
  }

  jwt.verify(token, process.env.JWT_SECRET, (err, user) => {
    if (err) return res.status(403).json({ error: '–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω' });
    req.user = user;
    next();
  });
};
```

### Middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

```javascript
const checkPermission = (requiredPermission) => {
  return (req, res, next) => {
    if (!req.user.permissions.includes(requiredPermission) && !req.user.permissions.includes('admin')) {
      return res.status(403).json({ error: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏' });
    }
    next();
  };
};
```

---

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

**–ö–æ–ª–ª–µ–∫—Ü–∏—è employees:**
```javascript
await db.collection('employees').createIndex({ name: 1 });
await db.collection('employees').createIndex({ department: 1 });
await db.collection('employees').createIndex({ position: 1 });
await db.collection('employees').createIndex({ salary: 1 });
await db.collection('employees').createIndex({ email: 1 }, { unique: true });
```

**–ö–æ–ª–ª–µ–∫—Ü–∏—è projects:**
```javascript
await db.collection('projects').createIndex({ name: 1 });
await db.collection('projects').createIndex({ status: 1 });
await db.collection('projects').createIndex({ department: 1 });
await db.collection('projects').createIndex({ startDate: 1, endDate: 1 });
```

**–ö–æ–ª–ª–µ–∫—Ü–∏—è departments:**
```javascript
await db.collection('departments').createIndex({ name: 1 }, { unique: true });
await db.collection('departments').createIndex({ location: 1 });
```

**–ö–æ–ª–ª–µ–∫—Ü–∏—è users:**
```javascript
await db.collection('users').createIndex({ username: 1 }, { unique: true });
```

---

## üé® –§—Ä–æ–Ω—Ç–µ–Ω–¥ —Ñ—É–Ω–∫—Ü–∏–∏

### 1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

**–§—É–Ω–∫—Ü–∏—è –≤—Ö–æ–¥–∞:**
```javascript
async function login(username, password) {
  try {
    const data = await apiRequest('/auth/login', {
      method: 'POST',
      body: { username, password }
    });
    
    authToken = data.token;
    currentUser = data.user;
    localStorage.setItem('authToken', authToken);
    localStorage.setItem('currentUser', JSON.stringify(currentUser));
    
    showMainApp();
    loadDashboard();
  } catch (error) {
    showAlert('loginAlert', error.message, 'danger');
  }
}
```

### 2. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö Dashboard

```javascript
async function loadDashboard() {
  try {
    const [employees, projects, departments, salaryStats] = await Promise.all([
      apiRequest('/employees'),
      apiRequest('/projects'),
      apiRequest('/departments'),
      apiRequest('/reports/salary-statistics')
    ]);
    
    document.getElementById('employeesCount').textContent = employees.length;
    document.getElementById('projectsCount').textContent = projects.length;
    document.getElementById('departmentsCount').textContent = departments.length;
    document.getElementById('avgSalary').textContent = salaryStats.avgSalary ? 
      Math.round(salaryStats.avgSalary).toLocaleString() + ' ‚ÇΩ' : '-';
  } catch (error) {
    console.error('Error loading dashboard:', error);
  }
}
```

### 3. CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤

**–ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤:**
```javascript
async function loadEmployees() {
  const loading = document.getElementById('employeesLoading');
  const tableBody = document.getElementById('employeesTableBody');
  
  loading.style.display = 'block';
  
  try {
    const employees = await apiRequest('/employees');
    
    tableBody.innerHTML = employees.map(employee => `
      <tr>
        <td>
          <div class="d-flex align-items-center">
            <i class="fas fa-user-circle fa-2x text-primary me-2"></i>
            <div>
              <div class="fw-bold">${employee.name}</div>
              <small class="text-muted">${employee.email}</small>
            </div>
          </div>
        </td>
        <td><span class="badge bg-secondary">${employee.position}</span></td>
        <td>${employee.department}</td>
        <td class="fw-bold">${employee.salary.toLocaleString()} ‚ÇΩ</td>
        <td>${employee.email}</td>
        <td>
          <button class="btn btn-sm btn-outline-primary me-1" onclick="editEmployee('${employee._id}')">
            <i class="fas fa-edit"></i>
          </button>
          ${currentUser.permissions.includes('admin') ? `
            <button class="btn btn-sm btn-outline-danger" onclick="deleteEmployee('${employee._id}')">
              <i class="fas fa-trash"></i>
            </button>
          ` : ''}
        </td>
      </tr>
    `).join('');
    
  } catch (error) {
    showAlert('employeesAlert', error.message, 'danger');
  } finally {
    loading.style.display = 'none';
  }
}
```

**–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞:**
```javascript
async function addEmployee() {
  const form = document.getElementById('addEmployeeForm');
  const formData = new FormData(form);
  
  const employee = {
    name: formData.get('name'),
    position: formData.get('position'),
    department: formData.get('department'),
    salary: parseInt(formData.get('salary')),
    email: formData.get('email'),
    phone: formData.get('phone'),
    skills: formData.get('skills') ? formData.get('skills').split(',').map(s => s.trim()) : [],
    hireDate: new Date()
  };
  
  try {
    await apiRequest('/employees', {
      method: 'POST',
      body: employee
    });
    
    bootstrap.Modal.getInstance(document.getElementById('addEmployeeModal')).hide();
    form.reset();
    loadEmployees();
    showToast('–°–æ—Ç—Ä—É–¥–Ω–∏–∫ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!', 'success');
  } catch (error) {
    showAlert('employeeModalAlert', error.message, 'danger');
  }
}
```

### 4. –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è

```javascript
async function searchEmployees() {
  const name = document.getElementById('searchEmployees').value;
  const department = document.getElementById('filterDepartment').value;
  const position = document.getElementById('filterPosition').value;
  
  const params = new URLSearchParams();
  if (name) params.append('name', name);
  if (department) params.append('department', department);
  if (position) params.append('position', position);
  
  try {
    const employees = await apiRequest(`/search/employees?${params.toString()}`);
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –ø–æ–∏—Å–∫–∞
  } catch (error) {
    console.error('Error searching employees:', error);
  }
}